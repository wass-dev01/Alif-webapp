<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#0a0f1e">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Alif">
<link rel="manifest" href="#" />
<title>Alif ‚Äî ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿµŸÑÿßÿ©</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300&family=Noto+Naskh+Arabic:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  :root {
    --gold: #c9a84c;
    --gold-light: #e8c97a;
    --gold-dim: rgba(201, 168, 76, 0.15);
    --bg: #050a14;
    --bg2: #0b1425;
    --bg3: #111e35;
    --text: #e8dfc8;
    --text-dim: rgba(232, 223, 200, 0.45);
    --active: #c9a84c;
    --card: rgba(255,255,255,0.04);
    --border: rgba(201, 168, 76, 0.18);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Cormorant Garamond', serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
  }

  /* Background stars */
  .stars {
    position: fixed;
    inset: 0;
    z-index: 0;
    overflow: hidden;
    pointer-events: none;
  }
  .stars::before, .stars::after {
    content: '';
    position: absolute;
    inset: 0;
    background-image:
      radial-gradient(1px 1px at 10% 15%, rgba(201,168,76,0.6) 0%, transparent 100%),
      radial-gradient(1px 1px at 25% 40%, rgba(255,255,255,0.4) 0%, transparent 100%),
      radial-gradient(1.5px 1.5px at 45% 8%, rgba(201,168,76,0.5) 0%, transparent 100%),
      radial-gradient(1px 1px at 60% 25%, rgba(255,255,255,0.3) 0%, transparent 100%),
      radial-gradient(1px 1px at 75% 55%, rgba(201,168,76,0.4) 0%, transparent 100%),
      radial-gradient(1.5px 1.5px at 88% 12%, rgba(255,255,255,0.5) 0%, transparent 100%),
      radial-gradient(1px 1px at 35% 70%, rgba(201,168,76,0.3) 0%, transparent 100%),
      radial-gradient(1px 1px at 55% 85%, rgba(255,255,255,0.25) 0%, transparent 100%),
      radial-gradient(1px 1px at 80% 78%, rgba(201,168,76,0.35) 0%, transparent 100%),
      radial-gradient(1px 1px at 15% 90%, rgba(255,255,255,0.3) 0%, transparent 100%),
      radial-gradient(1.5px 1.5px at 92% 45%, rgba(201,168,76,0.5) 0%, transparent 100%),
      radial-gradient(1px 1px at 5% 55%, rgba(255,255,255,0.2) 0%, transparent 100%);
  }
  .stars::after {
    background-image:
      radial-gradient(1px 1px at 20% 20%, rgba(255,255,255,0.2) 0%, transparent 100%),
      radial-gradient(1px 1px at 40% 35%, rgba(201,168,76,0.3) 0%, transparent 100%),
      radial-gradient(1px 1px at 70% 65%, rgba(255,255,255,0.25) 0%, transparent 100%),
      radial-gradient(1.5px 1.5px at 50% 50%, rgba(201,168,76,0.4) 0%, transparent 100%),
      radial-gradient(1px 1px at 85% 30%, rgba(255,255,255,0.3) 0%, transparent 100%);
    animation: twinkle 4s ease-in-out infinite alternate;
  }
  @keyframes twinkle {
    from { opacity: 0.4; }
    to { opacity: 1; }
  }

  /* Crescent moon decoration */
  .moon-deco {
    position: fixed;
    top: -80px;
    right: -60px;
    width: 280px;
    height: 280px;
    border-radius: 50%;
    box-shadow: -60px 60px 0 -20px rgba(201,168,76,0.08);
    pointer-events: none;
    z-index: 0;
  }

  /* Geometric pattern overlay */
  .pattern {
    position: fixed;
    inset: 0;
    z-index: 0;
    opacity: 0.025;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80'%3E%3Cpath d='M40 0 L80 40 L40 80 L0 40 Z' fill='none' stroke='%23c9a84c' stroke-width='0.5'/%3E%3Cpath d='M20 0 L60 40 L20 80' fill='none' stroke='%23c9a84c' stroke-width='0.5'/%3E%3Cpath d='M60 0 L20 40 L60 80' fill='none' stroke='%23c9a84c' stroke-width='0.5'/%3E%3C/svg%3E");
    pointer-events: none;
  }

  /* Main layout */
  .app {
    position: relative;
    z-index: 1;
    max-width: 420px;
    margin: 0 auto;
    min-height: 100vh;
    padding: 0 0 40px;
  }

  /* Header */
  header {
    padding: 50px 24px 32px;
    text-align: center;
    position: relative;
  }

  .app-name {
    font-family: 'Noto Naskh Arabic', serif;
    font-size: 2.8rem;
    font-weight: 700;
    color: var(--gold);
    letter-spacing: 0.05em;
    line-height: 1;
    text-shadow: 0 0 40px rgba(201,168,76,0.3);
    display: block;
  }

  .app-name-latin {
    font-family: 'Cormorant Garamond', serif;
    font-size: 0.85rem;
    letter-spacing: 0.35em;
    text-transform: uppercase;
    color: var(--text-dim);
    margin-top: 6px;
    display: block;
  }

  .divider {
    width: 60px;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
    margin: 18px auto;
  }

  .location-bar {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-size: 0.9rem;
    color: var(--text-dim);
    cursor: pointer;
    transition: color 0.3s;
  }
  .location-bar:hover { color: var(--gold-light); }
  .location-bar svg { width: 14px; height: 14px; fill: currentColor; }
  #city-name { font-weight: 600; }

  /* Hijri date */
  .hijri-date {
    text-align: center;
    padding: 0 24px 24px;
    font-size: 0.82rem;
    color: var(--text-dim);
    letter-spacing: 0.08em;
  }
  .hijri-arabic {
    font-family: 'Noto Naskh Arabic', serif;
    font-size: 1rem;
    color: var(--gold);
    display: block;
    margin-bottom: 4px;
  }

  /* Next prayer */
  .next-prayer-section {
    margin: 0 20px 28px;
    padding: 28px 24px;
    background: linear-gradient(135deg, rgba(201,168,76,0.12), rgba(201,168,76,0.04));
    border: 1px solid var(--border);
    border-radius: 20px;
    text-align: center;
    position: relative;
    overflow: hidden;
    animation: fadeUp 0.6s ease both;
  }
  .next-prayer-section::before {
    content: '';
    position: absolute;
    top: -1px; left: 20%; right: 20%;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
  }

  .next-label {
    font-size: 0.75rem;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--text-dim);
    margin-bottom: 10px;
  }
  .next-prayer-name {
    font-size: 2rem;
    font-weight: 300;
    color: var(--gold-light);
    letter-spacing: 0.05em;
    margin-bottom: 6px;
  }
  .next-prayer-arabic {
    font-family: 'Noto Naskh Arabic', serif;
    font-size: 1.4rem;
    color: var(--gold);
    margin-bottom: 14px;
  }
  .countdown {
    font-size: 2.6rem;
    font-weight: 300;
    color: var(--text);
    letter-spacing: 0.05em;
    font-variant-numeric: tabular-nums;
  }
  .countdown span { color: var(--gold); }

  /* Prayer list */
  .prayers-list {
    padding: 0 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .prayer-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    background: var(--card);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 16px;
    transition: all 0.3s ease;
    animation: fadeUp 0.5s ease both;
    position: relative;
    overflow: hidden;
    cursor: default;
  }
  .prayer-card:nth-child(1) { animation-delay: 0.05s; }
  .prayer-card:nth-child(2) { animation-delay: 0.1s; }
  .prayer-card:nth-child(3) { animation-delay: 0.15s; }
  .prayer-card:nth-child(4) { animation-delay: 0.2s; }
  .prayer-card:nth-child(5) { animation-delay: 0.25s; }
  .prayer-card:nth-child(6) { animation-delay: 0.3s; }

  .prayer-card.active {
    background: linear-gradient(135deg, rgba(201,168,76,0.15), rgba(201,168,76,0.05));
    border-color: rgba(201,168,76,0.4);
    box-shadow: 0 0 30px rgba(201,168,76,0.1), inset 0 1px 0 rgba(201,168,76,0.2);
  }
  .prayer-card.active::after {
    content: '';
    position: absolute;
    left: 0; top: 20%; bottom: 20%;
    width: 3px;
    background: var(--gold);
    border-radius: 0 3px 3px 0;
  }
  .prayer-card.passed {
    opacity: 0.45;
  }

  .prayer-left {
    display: flex;
    flex-direction: column;
    gap: 3px;
  }
  .prayer-name {
    font-size: 1.05rem;
    font-weight: 400;
    color: var(--text);
  }
  .prayer-card.active .prayer-name { color: var(--gold-light); font-weight: 600; }
  .prayer-arabic {
    font-family: 'Noto Naskh Arabic', serif;
    font-size: 0.9rem;
    color: var(--text-dim);
  }
  .prayer-card.active .prayer-arabic { color: var(--gold); }

  .prayer-right {
    display: flex;
    align-items: center;
    gap: 14px;
  }
  .prayer-time {
    font-size: 1.3rem;
    font-weight: 300;
    color: var(--text);
    letter-spacing: 0.03em;
    font-variant-numeric: tabular-nums;
  }
  .prayer-card.active .prayer-time { color: var(--gold-light); }

  .notif-btn {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s;
    color: var(--text-dim);
  }
  .notif-btn.enabled {
    background: rgba(201,168,76,0.2);
    border-color: rgba(201,168,76,0.5);
    color: var(--gold);
  }
  .notif-btn:hover { transform: scale(1.1); }
  .notif-btn svg { width: 14px; height: 14px; fill: currentColor; }

  /* Notification banner */
  .notif-banner {
    margin: 0 20px 20px;
    padding: 14px 18px;
    background: rgba(201,168,76,0.08);
    border: 1px solid rgba(201,168,76,0.25);
    border-radius: 14px;
    font-size: 0.82rem;
    color: var(--text-dim);
    display: flex;
    align-items: center;
    gap: 10px;
    animation: fadeUp 0.4s ease both;
  }
  .notif-banner svg { width: 18px; height: 18px; fill: var(--gold); flex-shrink: 0; }
  .notif-banner a {
    color: var(--gold);
    text-decoration: none;
    cursor: pointer;
  }
  .notif-banner.hidden { display: none; }

  /* Footer */
  footer {
    text-align: center;
    padding: 32px 24px 0;
    font-size: 0.75rem;
    color: var(--text-dim);
    letter-spacing: 0.05em;
  }
  footer .bismillah {
    font-family: 'Noto Naskh Arabic', serif;
    font-size: 1.2rem;
    color: var(--gold);
    display: block;
    margin-bottom: 8px;
  }

  /* Loader */
  .loader {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 60vh;
    gap: 20px;
  }
  .loader-icon {
    width: 60px;
    height: 60px;
    border: 2px solid var(--border);
    border-top-color: var(--gold);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  .loader p {
    color: var(--text-dim);
    font-size: 0.9rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* Error */
  .error-box {
    margin: 0 20px;
    padding: 20px;
    background: rgba(200, 80, 60, 0.1);
    border: 1px solid rgba(200, 80, 60, 0.3);
    border-radius: 16px;
    text-align: center;
    color: #e07060;
    font-size: 0.9rem;
  }
  .error-box button {
    margin-top: 14px;
    padding: 10px 24px;
    background: var(--gold-dim);
    border: 1px solid var(--border);
    border-radius: 40px;
    color: var(--gold);
    font-family: 'Cormorant Garamond', serif;
    font-size: 0.9rem;
    cursor: pointer;
    letter-spacing: 0.08em;
    transition: all 0.3s;
  }
  .error-box button:hover { background: rgba(201,168,76,0.25); }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Prayer icon */
  .prayer-icon {
    font-size: 1.1rem;
    margin-right: 2px;
  }
</style>
</head>
<body>

<div class="stars"></div>
<div class="moon-deco"></div>
<div class="pattern"></div>

<div class="app" id="app">
  <div class="loader" id="loader">
    <div class="loader-icon"></div>
    <p>Localisation en cours‚Ä¶</p>
  </div>
</div>

<script>
const PRAYERS_META = [
  { key: 'Fajr',   fr: 'Fajr',    ar: 'ÿßŸÑŸÅÿ¨ÿ±',   icon: 'üåô' },
  { key: 'Sunrise',fr: 'Chourouk', ar: 'ÿßŸÑÿ¥ÿ±ŸàŸÇ',  icon: 'üåÖ' },
  { key: 'Dhuhr',  fr: 'Dhuhr',   ar: 'ÿßŸÑÿ∏Ÿáÿ±',   icon: '‚òÄÔ∏è' },
  { key: 'Asr',    fr: 'Asr',     ar: 'ÿßŸÑÿπÿµÿ±',    icon: 'üå§' },
  { key: 'Maghrib',fr: 'Maghrib', ar: 'ÿßŸÑŸÖÿ∫ÿ±ÿ®',   icon: 'üåá' },
  { key: 'Isha',   fr: 'Isha',    ar: 'ÿßŸÑÿπÿ¥ÿßÿ°',   icon: 'üåë' },
];

let notifEnabled = {};
let prayerTimes = {};
let cityName = '';
let countdownInterval;
let notifTimeouts = [];

// ---- Geolocation ----
function init() {
  if (!navigator.geolocation) {
    showError("La g√©olocalisation n'est pas support√©e par ce navigateur.");
    return;
  }
  navigator.geolocation.getCurrentPosition(onPosition, onGeoError, { timeout: 12000 });
}

function onGeoError(err) {
  showError("Impossible d'obtenir votre position. Veuillez autoriser la g√©olocalisation.");
}

async function onPosition(pos) {
  const { latitude, longitude } = pos.coords;
  try {
    // Reverse geocode
    const geo = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${latitude}&lon=${longitude}&format=json`);
    const geoData = await geo.json();
    cityName = geoData.address?.city || geoData.address?.town || geoData.address?.village || 'Votre ville';

    // Prayer times from Aladhan API
    const today = new Date();
    const dd = String(today.getDate()).padStart(2,'0');
    const mm = String(today.getMonth()+1).padStart(2,'0');
    const yyyy = today.getFullYear();
    const res = await fetch(`https://api.aladhan.com/v1/timings/${dd}-${mm}-${yyyy}?latitude=${latitude}&longitude=${longitude}&method=2`);
    const data = await res.json();
    prayerTimes = data.data.timings;
    const hijri = data.data.date.hijri;

    renderApp(hijri);
    requestNotificationPermission();
    scheduleNotifications();
    startCountdown();
  } catch(e) {
    showError("Erreur lors du chargement des horaires. V√©rifiez votre connexion.");
  }
}

// ---- Render ----
function renderApp(hijri) {
  const app = document.getElementById('app');

  const hijriMonths = ['Mouharram','Safar','Rabi al-Awwal','Rabi al-Thani','Joumada al-Oula','Joumada al-Thania','Rajab','Chaabane','Ramadan','Chawwal','Dhou al-Qidah','Dhou al-Hijjah'];
  const hijriDate = `${hijri.day} ${hijriMonths[parseInt(hijri.month.number)-1] || hijri.month.en} ${hijri.year}`;
  const hijriAr = `${hijri.day} ${hijri.month.ar} ${hijri.year}`;

  const nextIdx = getNextPrayerIndex();

  app.innerHTML = `
    <header>
      <span class="app-name">ÿ£ŸÑŸÅ</span>
      <span class="app-name-latin">A L I F</span>
      <div class="divider"></div>
      <div class="location-bar" onclick="init()">
        <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
        <span id="city-name">${cityName}</span>
      </div>
    </header>

    <div class="hijri-date">
      <span class="hijri-arabic">${hijriAr}</span>
      ${hijriDate}
    </div>

    <div class="notif-banner ${Notification.permission === 'granted' ? 'hidden' : ''}" id="notif-banner">
      <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
      Activez les notifications pour recevoir les appels √† la pri√®re. <a onclick="requestNotificationPermission()">Activer</a>
    </div>

    <div class="next-prayer-section" id="next-section">
      <div class="next-label">Prochaine pri√®re</div>
      <div class="next-prayer-name" id="next-name">${PRAYERS_META[nextIdx].fr}</div>
      <div class="next-prayer-arabic">${PRAYERS_META[nextIdx].ar}</div>
      <div class="countdown" id="countdown">--:--:--</div>
    </div>

    <div class="prayers-list" id="prayers-list">
      ${PRAYERS_META.map((p, i) => {
        const time = formatTime(prayerTimes[p.key]);
        const isPassed = isPrayerPassed(p.key);
        const isActive = i === nextIdx;
        return `
        <div class="prayer-card ${isActive ? 'active' : ''} ${isPassed && !isActive ? 'passed' : ''}" id="card-${i}">
          <div class="prayer-left">
            <div class="prayer-name"><span class="prayer-icon">${p.icon}</span> ${p.fr}</div>
            <div class="prayer-arabic">${p.ar}</div>
          </div>
          <div class="prayer-right">
            <div class="prayer-time">${time}</div>
            <div class="notif-btn ${notifEnabled[p.key] ? 'enabled' : ''}" onclick="toggleNotif('${p.key}', ${i})" id="notif-${i}" title="Notification">
              <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
            </div>
          </div>
        </div>`;
      }).join('')}
    </div>

    <footer>
      <span class="bismillah">ÿ®ÿ≥ŸÖ ÿßŸÑŸÑŸá ÿßŸÑÿ±ÿ≠ŸÖŸÜ ÿßŸÑÿ±ÿ≠ŸäŸÖ</span>
      Alif ‚Äî Horaires de pri√®re
    </footer>
  `;
}

// ---- Helpers ----
function formatTime(timeStr) {
  if (!timeStr) return '--:--';
  const [h, m] = timeStr.split(':');
  return `${h}:${m}`;
}

function getPrayerDate(key) {
  const raw = prayerTimes[key];
  if (!raw) return null;
  const [h, m] = raw.split(':').map(Number);
  const d = new Date();
  d.setHours(h, m, 0, 0);
  return d;
}

function isPrayerPassed(key) {
  const d = getPrayerDate(key);
  return d && d < new Date();
}

function getNextPrayerIndex() {
  const now = new Date();
  for (let i = 0; i < PRAYERS_META.length; i++) {
    const d = getPrayerDate(PRAYERS_META[i].key);
    if (d && d > now) return i;
  }
  return 0; // Fajr of next day
}

function startCountdown() {
  if (countdownInterval) clearInterval(countdownInterval);
  countdownInterval = setInterval(updateCountdown, 1000);
  updateCountdown();
}

function updateCountdown() {
  const nextIdx = getNextPrayerIndex();
  const nextTime = getPrayerDate(PRAYERS_META[nextIdx].key);
  if (!nextTime) return;

  const now = new Date();
  let diff = nextTime - now;
  if (diff < 0) diff += 86400000; // next day

  const h = Math.floor(diff / 3600000);
  const m = Math.floor((diff % 3600000) / 60000);
  const s = Math.floor((diff % 60000) / 1000);

  const el = document.getElementById('countdown');
  const nameEl = document.getElementById('next-name');
  if (el) {
    el.innerHTML = `<span>${String(h).padStart(2,'0')}</span>:<span>${String(m).padStart(2,'0')}</span>:<span>${String(s).padStart(2,'0')}</span>`;
  }

  // Update active card
  PRAYERS_META.forEach((p, i) => {
    const card = document.getElementById(`card-${i}`);
    if (!card) return;
    const passed = isPrayerPassed(p.key);
    const active = i === nextIdx;
    card.className = `prayer-card ${active ? 'active' : ''} ${passed && !active ? 'passed' : ''}`;
  });

  if (nameEl) nameEl.textContent = PRAYERS_META[nextIdx].fr;

  // Arabic name
  const arEl = document.querySelector('.next-prayer-arabic');
  if (arEl) arEl.textContent = PRAYERS_META[nextIdx].ar;
}

// ---- Notifications ----
async function requestNotificationPermission() {
  if (!('Notification' in window)) return;
  if (Notification.permission === 'default') {
    const perm = await Notification.requestPermission();
    if (perm === 'granted') {
      const banner = document.getElementById('notif-banner');
      if (banner) banner.classList.add('hidden');
      // Enable all by default
      PRAYERS_META.forEach(p => { notifEnabled[p.key] = true; });
      scheduleNotifications();
      // Update buttons
      PRAYERS_META.forEach((p, i) => {
        const btn = document.getElementById(`notif-${i}`);
        if (btn) btn.classList.add('enabled');
      });
    }
  } else if (Notification.permission === 'granted') {
    if (Object.keys(notifEnabled).length === 0) {
      PRAYERS_META.forEach(p => { notifEnabled[p.key] = true; });
    }
  }
}

function toggleNotif(key, idx) {
  if (Notification.permission !== 'granted') {
    requestNotificationPermission();
    return;
  }
  notifEnabled[key] = !notifEnabled[key];
  const btn = document.getElementById(`notif-${idx}`);
  if (btn) btn.classList.toggle('enabled', notifEnabled[key]);
  scheduleNotifications();
}

function scheduleNotifications() {
  // Clear existing
  notifTimeouts.forEach(t => clearTimeout(t));
  notifTimeouts = [];

  if (Notification.permission !== 'granted') return;

  PRAYERS_META.forEach(p => {
    if (!notifEnabled[p.key]) return;
    const d = getPrayerDate(p.key);
    if (!d) return;
    const delay = d - Date.now();
    if (delay <= 0) return;

    const t = setTimeout(() => {
      new Notification(`üïå ${p.fr} ‚Äî ${p.ar}`, {
        body: `C'est l'heure de la pri√®re de ${p.fr} √† ${cityName}. ÿ≥ÿ®ÿ≠ÿßŸÜ ÿßŸÑŸÑŸá`,
        icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="32" fill="%230b1425"/><text y="42" x="32" text-anchor="middle" font-size="36">üïå</text></svg>',
        badge: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="32" fill="%23c9a84c"/></svg>',
        tag: p.key,
        silent: false
      });
    }, delay);
    notifTimeouts.push(t);
  });
}

function showError(msg) {
  const app = document.getElementById('app');
  app.innerHTML = `
    <header>
      <span class="app-name">ÿ£ŸÑŸÅ</span>
      <span class="app-name-latin">A L I F</span>
    </header>
    <div class="error-box">
      <p>${msg}</p>
      <button onclick="location.reload()">R√©essayer</button>
    </div>`;
}

// ---- Start ----
init();
</script>
</body>
</html>
